---
create_date: 2025-03-11
tags:
  - 网络
  - RPC
---

### 什么是RPC

RPC（Remote Procedure Call Protocol）远程过程调用协议。一个通俗的描述是：客户端在不知道调用细节的情况下，调用存在于远程计算机上的某个对象，就像调用本地应用程序中的对象一样。

比较正式的描述是：**一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议**。

此时对RPC可以知道

- RPC只是一个协议，其有很多按照RPC规范实现的不同的服务框架，例如[[Dubbo]]，[[Thrift]]，[[gRPC]]，[[Hetty]]等
- 网络协议和网络IO模型对其透明：RPC既然是用本地对象调用的服务，其中存在的网络请求对RPC来说是无感的，其中使用的传输层协议（[[TCP]]和[[UDP]]），或者应用层协议（[[Http]]和[[protobuf]]），RPC的对象对其都是不关心的
- 信息格式对其透明：我们知道在本地应用程序中，对于某个对象的调用需要传递一些参数，并且会返回一个调用结果。就像函数调用一样，函数中做了什么不重要，只需要知道最终返回的结果是没有问题就行
- 有跨语言的能力：一般的网络服务器都有这样的特性

![[Excalidraw/RPC调用过程.excalidraw]]

### 为什么要用RPC

其实这是应用开发到一定的阶段的强烈需求驱动的。如果我们开发简单的单一应用，逻辑简单、用户不多、流量不大，那我们用不着。当我们的系统访问量增大、业务增多时，我们会发现一台单机运行此系统已经无法承受。此时，我们可以将业务拆分成几个互不关联的应用，分别部署在各自机器上，以划清逻辑并减小压力。此时，我们也可以不需要RPC，因为应用之间是互不关联的。[^1]

当我们的业务越来越多、应用也越来越多时，自然的，我们会发现有些功能已经不能简单划分开来或者划分不出来。此时，可以将公共业务逻辑抽离出来，将之组成独立的服务Service应用 。而原有的、新增的应用都可以与那些独立的Service应用 交互，以此来完成完整的业务功能。

所以此时，我们急需一种高效的应用程序之间的通讯手段来完成这种需求，这就是RPC的使用范畴。[^2]

其实描述的场景也是服务化 、微服务和分布式系统架构的基础场景。即RPC框架就是实现以上结构的有力方式。

### 常用的RPC框架

- Thrift：thrift是一个软件框架，用来进行可扩展且跨语言的服务的开发。它结合了功能强大的软件堆栈和代码生成引擎，以构建在 C++, Java, Python, PHP, Ruby, Erlang, Perl, Haskell, C#, Cocoa, JavaScript, Node.js, Smalltalk, and OCaml 这些编程语言间无缝结合的、高效的服务。
- gRPC：一开始由 google 开发，是一款语言中立、平台中立、开源的远程过程调用(RPC)系统。
- Dubbo：Dubbo是一个分布式服务框架，以及SOA治理方案。其功能主要包括：高性能NIO通讯及多协议集成，服务动态寻址与路由，[[负载均衡]]与容错，依赖分析与降级等。Dubbo是阿里巴巴内部的SOA服务化治理方案的核心框架，Dubbo自2011年开源后，已被许多非阿里系公司使用。
- Spring Cloud：Spring Cloud由众多子项目组成，如Spring Cloud Config、Spring Cloud Netflix、Spring Cloud Consul 等，提供了搭建分布式系统及微服务常用的工具，如配置管理、服务发现、断路器、智能路由、微代理、控制总线、一次性token、全局锁、选主、分布式会话和集群状态等，满足了构建微服务所需的所有解决方案。Spring Cloud基于Spring Boot, 使得开发部署极其简单。

|   框架   | 开发语言 | 服务治理 |  多种序列化   | 多种注册中心 | 管理中心 | 跨语言通信 | 整理性能 |
| :----: | :--: | :--: | :------: | :----: | :--: | :---: | :--: |
| Dubbo  | Java |  √   |    √     |   √    |  √   |   ×   |  3   |
|  gRPC  | 跨语言  |  ×   | protobuf |   ×    |  ×   |   √   |  3   |
| Thrift | 跨语言  |  ×   |  thrift  |   ×    |  ×   |   √   |  5   |

[^1]: 这指的是微服务框架，将服务以模块划分，使每个服务各自做自己的事，各个服务之间互不干扰

[^2]: 指的是某些公共的服务模块，这方面主要是在多个服务调用过程中想调用RPC的调用比Http快，且性能更优秀，同时RPC协议属于更底层的协议，可以对服务的报文有更多的定制化，做到更大的吞吐量和并发数
