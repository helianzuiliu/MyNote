---
tags:
  - 软件设计师
aliases:
  - DeadLock
  - deadlock
---

死锁是多线程运行中，多个线程抢占系统资源且不释放，导致最终所有线程都无法使用手中的资源完成指定任务导致死循环的过程

死锁的产生有四大条件

- 互斥：指的是不能共享的系统资源，线程取走资源之后，为了保持自己的资源是完整的，所以不会让其他线程访问自己的资源，这部分资源被称为[[临界资源]]，同时，也存在互斥的资源，这些资源大多是只读或线程安全的数据
- 环路等待：指多个线程互相等待对方释放资源，导致A等B，B等C，C等A这种无限等待
- 保持和等待：指该进程持续占有自己的资源，并等待其他线程释放资源以让自己获得足够的资源以完成任务
- 不剥夺：指系统不会将已经分配出去的资源强制回收并分配给其他线程

## 死锁的预防

打破四大条件

- 互斥：将部分临界资源转换为非临界资源，使资源可以多线程访问
- 保持和等待：如果长时间没法获得自己需要的资源就将自己已经有的资源释放出去，让其他线程获得足够的资源以完成任务并释放其他线程原有的资源
- 不剥夺：剥夺，当系统认为可能出现死锁时，将已分配的资源给强行剥夺给其他线程使用、

## 死锁的避免

相对死锁的预防，常用的是死锁的避免

- 有序的资源分配
- [[银行家算法]]